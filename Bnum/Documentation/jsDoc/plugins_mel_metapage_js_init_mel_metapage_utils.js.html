<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: plugins/mel_metapage/js/init/mel_metapage_utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: plugins/mel_metapage/js/init/mel_metapage_utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Met en pause une fonction asynchrone.
 * @param {number} ms 
 */
const delay = ms => new Promise(res => setTimeout(res, ms));

/**
 * Vérifie si une fonction est asynchrone
 * @param {Function} myFunction 
 * @returns {boolean}
 */
const isAsync = myFunction => myFunction.constructor.name === "AsyncFunction";

/**
 * Attend que la fonction soit vrai
 * @param {Function} func 
 * @param {number} waitTime ms 
 */
const wait = async function (func, waitTime = 500)
{
    while ((isAsync(func) ? await func() : func()))
    {
        await delay(waitTime);
    }
}

const ping = async function(url, useSSL = true)
{

    // //let ip = url;

    // var _that = this;

    // let img = new Image();

    // img.onload = function() {_that.ok = true;};
    // img.onerror = function(e) {_that.ok = false; console.error(e);};

    // //let start = new Date().getTime();
     let ssl = useSSL ? "https" : "http";
    // img.src = !url.includes("https") &amp;&amp; !url.includes("http") ? (ssl + "://" + url) : url;
    // console.log(img.src);
    // let timer = setTimeout(function() { _that.ok = false;}, waitTime*1000);
    // await wait(() => _that.ok === undefined);
    // clearTimeout(timer)
    // return _that.ok;
    let ok;
    try {
        await $.ajax({
            type: "GET",
            url: !url.includes("https") &amp;&amp; !url.includes("http") ? (ssl + "://" + url) : url,
            success: function(result){
            ok = true;
            },     
            error: function(result){
                ok = false;
            }
        });
    } catch (error) {
        console.error(error);
        ok = false;
    }
    return ok;
}

const mceToRcId = function (txt = "")
{
    return txt.replaceAll(".", '_-P-_').replaceAll("@", "'_-A-_'").replaceAll("%", '_-C-_');
};

(()=> {
    function ureplacer(pmatch) {
        var ret = ""
        pmatch = pmatch.replace(/\,/g,'/')
        var ix = pmatch.substr(1,pmatch.length-2)
    
        if (ix.length % 4 != 0) 
          ix = ix.padEnd(ix.length+ 4 - ix.length % 4,"=")
        try {
        var dx = atob(ix)
        for (var j = 0; j &lt; dx.length; j = j+2) {
            ret = ret + String.fromCharCode((dx.charCodeAt(j) &lt;&lt; 8) + dx.charCodeAt(j+1))
        }
        } catch(err) {
        console.log("Error in decoding foldername IMAP UTF7, sending empty string back")
        console.log(err)
        ret = ""
        }
        return ret
    }
    
    function breplacer(umatch) {
        var bst = ""
        for (var i=0; i &lt; umatch.length; i++) {
          var f = umatch.charCodeAt(i)
          bst = bst + String.fromCharCode(f >> 8) + String.fromCharCode(f &amp; 255)
        }
    
        try {
        bst = '&amp;'+btoa(bst).replace(/\//g,',').replace(/=+/,'')+'-'
        }catch(err) {
        console.log("Error in encoding foldername IMAP UTF7, sending empty string back")
        console.log(err)
        bst = ""
        }
        return bst
    }
    
    function decode_imap_utf7(mstring) {
        var stm = new RegExp(/(\&amp;[A-Za-z0-9\+\,]+\-)/,'g')
        return mstring.replace(stm,ureplacer).replace('&amp;-','&amp;')
    }
    
    function encode_imap_utf7(ustring) {
        ustring = ustring.replace(/\/|\~|\\/g,'')
        var vgm = new RegExp(/([^\x20-\x7e]+)/,'g')
        return ustring.replace('&amp;','&amp;-').replace(vgm,breplacer)
    }

    function setCookie(cname, cvalue, exdays) {
        const d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        let expires = "expires="+ d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    window.decode_imap_utf7 = decode_imap_utf7;

    window.melSetCookie = setCookie;

    window.getCookie = (name) => {
        return rcmail.get_cookie(name);
    };

    window.removeCookie = (name) => {
        setCookie(name, '', -5);
    };
    
})();
/**
 * Lien du chargement des évènements d'un calendrier.
 */
const ev_calendar_url = '?_task=calendar&amp;_action=load_events';

/**
 * Liste des différents données constantes utile pour le plugin "mel_metapage".
 */
const mel_metapage = {
    /**
     * Liste des différents évènements.
     */
    EventListeners: {
        /**
         * Lorsque le calendrier est mis à jours.
         */
        calendar_updated:new EventListenerDatas("mel_metapage.calendar_updated"),
        /**
         * Lorsque les tâches sont mises à jours. 
         */
        tasks_updated:new EventListenerDatas("mel_metapage.tasks_updated"),
        /**
         * Lorsque les mails sont mis à jours.
         */
        mails_updated: new EventListenerDatas("mel_metapage.mails_updated"),
        /**
         * Lorsque le stockage est mis à jours.
         */
        wsp_stockage_updated: new EventListenerDatas("mel_metapage.wsp_stockage_updated"),
        workspaces_updated: new EventListenerDatas("workspace.updated")
    },
    /**
     * Différents clés de stockage local.
     */
    Storage: {
        unexist:Symbol("unexist"),
        exists(val)
        {
            return (val ?? this.unexist) !== this.unexist;
        },
        /**
         * 
         * @returns {MelDataStore}
         */
        _getDataStore() {
            let self = (top ?? window).mel_metapage.Storage;

            if (!self._getDataStore.datastoreobject) {
                const current_user_key = `bnum.${rcmail.env.username}`
                self._getDataStore.datastoreobject = new MelDataStore(current_user_key, {});

                if (rcmail.env.keep_login) {
                    const keys = Object.keys(localStorage);

                    for (let index = 0, len = keys.length; index &lt; len; ++index) {
                        const key = keys[index];
                        
                        if (key !== current_user_key &amp;&amp; key.includes('bnum')) {
                            localStorage.removeItem(key);
                        }
                    }
                }
            }

            return self._getDataStore.datastoreobject;
        },
        /**
         * Récupère une donnée depuis le stockage local.
         * @param {string} key Clé de la donnée à récupérer.
         */
        get(key, _default = null) {
            let self = mel_metapage.Storage;
            try {
                return self._getDataStore().get(key) ?? _default;
            } catch (error) {
                console.error(error);
                return self.unexist;
            }
        },
        /**
         * Ajoute ou modifie une donnée dans le stockage local.
         * @param {string} key Clé de la donnée pour la retrouver. 
         * @param {*} item Donnée à sauvegarder.
         */
        set(key, item, stringify = true)
        {
            this._getDataStore().set(key, item);
            this.setStoreChange(key, item);
        },
        /**
         * Supprime une donnée dans le stockage local.
         * @param {string} key Clé de la donnée à supprimer.
         */
        remove(key){
            this._getDataStore().remove(key);
            this.setStoreChange(key, undefined);
        },
        setStoreChange(key, item)
        {
            if ((top ?? window).rcmail !== undefined) (top ?? window).rcmail.triggerEvent('storage.change', {key, item});

            (top ?? window).$('iframe.mm-frame').each((i,e) => {
                try {
                    e.contentWindow.rcmail.triggerEvent('storage.change', {key, item});
                } catch (error) {
                    
                }
            });
        },
        getAppStorageSize() {
            return this._getDataStore().getSize();
        },
        check(storage = null)
        {
            if (storage === null)
            {
                let items = [];
                for (const key in mel_metapage.Storage) {
                    const element = mel_metapage.Storage[key];
                    if (element !== undefined) {
                       items.push(mel_metapage.Storage.check_day(key));
                    }                  
                }

                return {
                    items:items,
                    wait:async function()
                    {
                        for (let index = 0; index &lt; this.items.length; ++index) {
                            const element = this.items[index];
                            if (element.wait !== undefined)
                                await element.wait();
                        }
                    }
                }
            }
            else {
                const update_element = (update_key, day_key) => {
                    let item = {
                        wait:async () => {return mel_metapage.Storage.get(update_key);}
                    }
                    let update = false;
                    if (!update &amp;&amp; moment(mel_metapage.Storage.get(day_key)).format("DD/MM/YYYY") !== moment().format("DD/MM/YYYY"))
                        update = true;
                    if (!update &amp;&amp; mel_metapage.Storage.get(update_key) === null)  
                        update = true;
                    if (update)
                    {
                        mel_metapage.Storage.remove(update_key);
                        workspaces.sync.PostToParent({
                            exec:"rcmail.mel_metapage_fn.tasks_updated()",
                            child:false
                        })
                        item.wait = async () => {
                            await wait(() => mel_metapage.Storage.get(update_key) === null);
                            return mel_metapage.Storage.get(update_key);
                        };        
                    }
                    return item;
                };

                switch (storage) {
                    case mel_metapage.Storage.other_tasks:
                    case mel_metapage.Storage.tasks:
                        return update_element(storage, mel_metapage.Storage.last_task_update);
                    case mel_metapage.Storage.calendar_all_events:
                    case mel_metapage.Storage.calendar:
                        return update_element(storage, mel_metapage.Storage.last_calendar_update);
                    default:
                        return item;
                }
            }
        },
        /**
         * Clé des données du calendrier.
         */
        calendar_all_events:CONST_STORAGE_KEY_ALL_EVENTS,
        calendar:"mel_metapage.calendar",
        calendar_by_days:"mel_metapage.calendars.by_days",
        calendars_number_wainting:"mel_metapage.calendars.by_days.waiting",
        /**
         * Clé des données des tâches.
         */
        tasks:"mel_metapage.tasks",
        other_tasks:"mel_metapage.tasks.others",
        other_tasks_count:"mel_metapage.tasks.others.count",
        /**
         * Clé du nombre de mail non lus.
         */
        mail:"mel_metapage.mail.count",
        wsp_mail:"mel_metapage.wsp.mails",
        last_calendar_update:"mel_metapage.calendar.last_update_2",
        last_task_update:"mel_metapage.tasks.last_update",
        ariane:"ariane_datas",
        wait_frame_loading:"mel_metapage.wait_frame_loading",
        wait_frame_waiting:"waiting...",
        wait_frame_loaded:"loaded",
        wait_call_loading:"mel_metapage.call.loading",
        color_mode:'colorMode',
        title_workspaces:'workspaces.title'
    },
    /**
     * Liste des symboles.
     */
    Symbols: {
        /**
         * Symboles du plugin "My_Day".
         */
        my_day:{
            /**
             * Symbole "Calendrier", est utilisé pour savoir si il faut mettre à jours uniquement les évènements ou non.
             */
            calendar:Symbol("calendar"),
            /**
             * Symbole "Tâches", est utilisé pour savoir si il faut mettre à jours uniquement les tâches ou non.
             */
            tasks:Symbol("tasks")
        },
        nextcloud:{
            folder:Symbol("folder"),
            file:Symbol("file")
        },
        navigator:{
            firefox:Symbol('firefox')
        },
        null:Symbol("null")
    },
    /**
     * Les différents Identifiants
     */
    Ids: {
        /**
         * Ids pour le menu.
         */
        menu:{
            /**
             * Id des différents badges du menu.
             */
            badge:{
                calendar:"menu-badge-calendar",
                tasks:"menu-badge-tasks",
                mail:"menu-badge-mail",
                ariane:"menu-badge-ariane"
            }
        },
        create:{
            doc_input:"generated-document-input-mel-metapage",
            doc_input_ext:"generated-document-input-mel-metapage-ext",
            doc_input_hidden:"generated-document-input-mel-metapage-hidden",
            doc_input_path:"generated-document-select-mel-metapage-path"
        }
    },
    PopUp:{
        /**
         * Ouvre la popup de chat 
         * @returns 
         */
        open_ariane() {
            if (rcmail.busy)
                return;

            if (mel_metapage.PopUp.ariane === null)
            {
                mel_metapage.PopUp.ariane = new ArianePopUp(ArianeButton.default());
                rcmail.addEventListener('toggle-options-user', (show) => {
                    let $iframe =  mel_metapage.PopUp.ariane.ariane.card.body.card.find('iframe');

                    if (show.show === true) $iframe.css("z-index", '1');
                    else $iframe.css("z-index", '');
                    
                });
            }
        
            if (mel_metapage.PopUp.ariane.is_show === true)
                mel_metapage.PopUp.ariane.hide();
            else
                mel_metapage.PopUp.ariane.show();
        },
        ariane:null,
    },
    Other:{
        webconf:{
            private:'/group'
        }
    },
    RCMAIL_Start:{
        async ping_nextcloud()
        {
            if (rcmail.env.nextcloud_url !== undefined &amp;&amp; rcmail.env.nextcloud_url !== null &amp;&amp; rcmail.env.nextcloud_url !== "")
            {
                rcmail.env.nextcloud_pinged = await ping(rcmail.env.nextcloud_url);
                if (rcmail.env.nextcloud_pinged === false)
                    rcmail.env.nextcloud_pinged = await ping(rcmail.env.nextcloud_url, true);
            }
        }
    },
    Frames:{
        max:10,
        lastFrames:[],
        add(frame)
        {
            if (parent !== window) return parent.mel_metapage.Frames.add(frame);

            if (frame?.task === 'webconf') return this;

            if (this.lastFrames.length + 1 > 5) this.lastFrames.pop();

            this.lastFrames.push(frame);
            return this;
        },
        reset()
        {
            if (parent !== window) return parent.mel_metapage.Frames.reset();

            this.lastFrames = [];
            return this;
        },
        pop()
        {
            if (parent !== window) return parent.mel_metapage.Frames.pop();

            if (this.lastFrames.length === 0) return null;

            return this.lastFrames.pop();
        },
        last(it = 0)
        {
            if (parent !== window) return parent.mel_metapage.Frames.last(it);

            if (this.lastFrames.length === 0) return null;

            return this.lastFrames[this.lastFrames.length - 1 - it];
        },
        back(_default = "home")
        {
            
            if (parent !== window) return parent.mel_metapage.Frames.back(_default);

            const unexist = mel_metapage.Storage.unexist;
            let last = this.pop()?.task || _default;

            if (last === unexist) last = _default;

            return mel_metapage.Functions.change_frame(last, true, true).then(() => {
                if ($('.menu-last-frame').hasClass('disabled'))
                {
                    m_mp_ChangeLasteFrameInfo();
                }
            });
        },
        create_frame(name, task, icon)
        {
            return {
                name,
                task,
                icon
            };
        }
    },
    Functions:{
        /**
         * Copie un texte dans le press-papier
         * @param {string} text Texte à copier
         */
        copy(text)
        {
            function copyOnClick (val) {
                var tempInput = document.createElement ("input"); 
                tempInput.value = val;
                 document.body.appendChild (tempInput); 
                 tempInput.select (); 
                 document.execCommand ("copy"); 
                 document.body.removeChild (tempInput); 
            }

            copyOnClick(text);
            rcmail.display_message(`${text} copier dans le presse-papier.`, "confirmation");

            return this;
        },

        /**
         * Récupère les données du calendrier entre deux dates.
         * @param {moment} start (moment) Début des évènements à récupérer
         * @param {moment} end (moment) Fin des évènements à récupérer
         */
        update_calendar(start, end){
            start = start.format("YYYY-MM-DDTHH:mm:ss");
            end = end.format("YYYY-MM-DDTHH:mm:ss");
            
            if (rcmail.env.ev_calendar_url === undefined)
                rcmail.env.ev_calendar_url = ev_calendar_url;

            return $.ajax({ // fonction permettant de faire de l'ajax
            type: "GET", // methode de transmission des données au fichier php
            url: rcmail.env.ev_calendar_url+`&amp;source=${mceToRcId(rcmail.env.username)}`+'&amp;start='+start+'&amp;end='+end, // url du fichier php
            success: function (data) {
                try {
                    let events = [];
                    data = JSON.parse(data);
                    data = Enumerable.from(data).where(x => mel_metapage.Functions.check_if_date_is_okay(x.start, x.end, start) || mel_metapage.Functions.check_if_date_is_okay(x.start, x.end, end)).toArray();
                    return data;

  
                } catch (ex) {
                    console.error(ex);
                    rcmail.display_message("Une erreur est survenue lors de la synchronisation.", "error")
                }
            },
            error: function (xhr, ajaxOptions, thrownError) { // Add these parameters to display the required response
                console.error(xhr, ajaxOptions, thrownError);
                rcmail.display_message("Une erreur est survenue lors de la synchronisation.", "error")
            },
         });
        },

        /**
         * Vérifie si un élement est valide ou si c'est un doublon ou une instance originale
         * @param {JSON} element 
         * @param {Array&lt;JSON>} events 
         * @param {boolean} test 
         * @returns {boolean|JSON} True si pas de problème | Evènement problématique
         */
        check_if_calendar_valid(element, events, test=true)
        {
            if (mceToRcId(rcmail.env.username) !== element.calendar)
                return false;
            else {
                if (element._instance !== undefined &amp;&amp; test)
                {
                    for (let it = 0; it &lt; events.length; it++) {
                        const event = events[it];
                        if (event.uid === element.uid &amp;&amp; event._instance === undefined)
                            return event;
                    }
                }
            }
            return true;
        },

        /**
         * Vérifie si une date se trouve entre 2 dates
         * @param {string|moment} sd 
         * @param {string|moment} ed 
         * @param {string|moment} date 
         * @returns {boolean}  
         */
        check_if_date_is_okay(sd, ed, date)
        {
            if (typeof sd === "string")
                sd = moment(sd).startOf("day");

            if (typeof ed === "string")
                ed = moment(ed).endOf("day");

            if (typeof date === "string")
                date = moment(date);

            startDate = moment(date).startOf("day");
            endDate = moment(date).endOf("day");

            if (startDate &lt;= sd &amp;&amp; sd &lt;= endDate)
                return true;
            else if (startDate &lt;= ed &amp;&amp; ed &lt;= endDate)
                return true;
            else if (sd &lt;= startDate &amp;&amp; startDate &lt;= ed &amp;&amp; sd &lt;= endDate &amp;&amp; endDate &lt;= ed)
                return true;
            else
                return false;
            
        },

        get_from_url(url) {
            const URL_VARIABLE = '/?';
            const URL_SEPARATOR = '&amp;';
            url = url.split(URL_VARIABLE)[1].split(URL_SEPARATOR);
            let datas = {};

            for (let index = 0, len = url.length; index &lt; len; ++index) {
                const element = url[index].split('=');
                datas[element[0]] = element[1];
            }

            return datas;
        },

        /**
         * Récupère une URL conforme.
         * @param {string} task Tâche 
         * @param {string} action Action
         * @param {JSON} args divers arguments ex {_eventType:1}
         * @returns {string}
         */
        url(task, action = "", args = null)
        {
            let url = task;
            if (action !== null &amp;&amp; action !== undefined &amp;&amp; action !== "")
                url += "&amp;_action=" + action;

            if (window.location.href.includes(`${rcmail.env.mel_metapage_const.key}=${rcmail.env.mel_metapage_const.value}`) || window !== parent)
            {
                if (args === null || args === undefined)
                {
                    args = {};
                    args[rcmail.env.mel_metapage_const.key] = rcmail.env.mel_metapage_const.value;
                }
                else if (args[rcmail.env.mel_metapage_const.key] === undefined)
                    args[rcmail.env.mel_metapage_const.key] = rcmail.env.mel_metapage_const.value;
            }

            if (args !== null)
            {
                for (const key in args) {
                    if (Object.hasOwnProperty.call(args, key)) {
                        const element = args[key];
                        url += "&amp;" + key + "=" + element
                    }
                }
            }
            return rcmail.get_task_url(url, window.location.origin + window.location.pathname)
        },

        public_url(path, args = null)
        {
            let url = window.location.origin + window.location.pathname + (window.location.pathname[window.location.pathname.length - 1] === '/' ? '' : '/') + 'public/' + path;

            if (args !== null)
            {
                for (const key in args) {
                    if (Object.hasOwnProperty.call(args, key)) {
                        const element = args[key];
                        url += (url.includes('?') ? "&amp;" : '?') + key + "=" + element
                    }
                }
            }

            return url;
        },

        /**
         * Change de frame, même si l'on est pas depuis "TOP"
         * @param {string} frame Frame à ouvrir
         * @param {boolean} changepage Si vrai, on change de page, sinon la page ouverte sera caché.
         * @param {boolean} waiting Si l'on veux attendre que la frame sois ouverte ou non.
         * @param {JSON} args Arguments à ajouter dans l'url de la frame.
         */
        async change_frame(frame, changepage = true, waiting = false, args = null, actions = [])
        {
            if (changepage) (top ?? window).rcmail.set_busy(true, 'loading');

            // if (frame === "webconf")
            // {
            //     var initial_change_page = changepage;
            //     changepage = false;
            // }

            if (waiting)
                mel_metapage.Storage.set(mel_metapage.Storage.wait_frame_loading, mel_metapage.Storage.wait_frame_waiting);

            (top ?? window).rcmail.env.can_change_while_busy = true;
            (top ?? window).mm_st_OpenOrCreateFrame(frame, changepage, args, actions);
            
            if (waiting)
            {
                await wait(() => mel_metapage.Storage.get(mel_metapage.Storage.wait_frame_loading) !== mel_metapage.Storage.wait_frame_loaded);
                mel_metapage.Storage.remove(mel_metapage.Storage.wait_frame_loading);
            }

            // if (frame === "webconf")
            // {
            //     if (initial_change_page)
            //     {
            //         (top ?? window).mm_st_OpenOrCreateFrame(frame, initial_change_page, args, actions);
            //     }
            //     //this.update_refresh_thing();
            // }

            if (changepage &amp;&amp; (top ?? window).rcmail.busy) 
            {
                (top ?? window).rcmail.set_busy(false);
                rcmail.clear_messages();
            }
            
            return this;
        },

        /**
         * Change de page en utilisant le combo tâche + action.
         * @param {string} task  
         * @param {string} action 
         * @param {JSON} params 
         * @returns 
         */
        async change_page(task, action = null, params = {}, update = true, force = false)
        {
            let contracted_task;
            let $querry;

            if (window !== parent) return await parent.mel_metapage.Functions.change_page(task, action, params, update, force);

            contracted_task = mm_st_ClassContract(task);

            if (action !== null) params['_action'] = action;

            $querry = $(`iframe.${task}-frame`);

            if (update)
            {
                if ($querry.length > 0)
                {
                    params[rcmail.env.mel_metapage_const.key] = rcmail.env.mel_metapage_const.value;
                    action = mel_metapage.Functions.url(task, null, params);

                try {
                        if ($querry[0].contentWindow.location.href !== action) $querry[0].src = action;
                        else if (force) {
                            $querry[0].contentWindow.location.reload();
                        }
                } catch (error) {
                    
                }
                }
                else if ($(`.${task}-frame`).length > 0)
                {
                    action = mel_metapage.Functions.url(task, null, params);
                    if (window.location.href !== action) $(`.${task}-frame`).remove();
                }
            }

            return await this.change_frame(contracted_task, true, true, params);
        },

        /**
         * Ouvre la page de chat, avec un can/group/tem associé ou non.
         * @param {string} channel_or_group group/ ou channel/
         * @returns {Promise}
         */
        open_chat(channel_or_group = null)
        {
            return mel_metapage.Functions.change_frame('rocket', true, true).then(() => {
                if (channel_or_group !== null &amp;&amp; channel_or_group !== undefined)
                {
                    if (channel_or_group[0] !== '/')
                    channel_or_group = `/${channel_or_group}`;
                    parent.$('.discussion-frame')[0].contentWindow.postMessage({
                        externalCommand: 'go',
                        path: channel_or_group
                    }, '*')
            }
            });
        },


        /**
         * F5 une frame
         * @param {string} frame Classe de la frame à refresh
         * @returns Chaînage
         */
        update_frame(frame)
        {
            this.call("reload_frame", false, {
                _integrated:true,
                always:true,
                args:[`${frame}-frame`]
            });

            return this;
        },

        /**
         * Reviens à la frame d'avant.
         * @param {boolean} wait Si l'on doit attendre le changement de frame ou non.
         * @param {string} default_frame Frame par défaut si il n'y a pas de frame d'avant. Si null, ne fait rien dans ce cas.
         */
        async frame_back(wait = true, default_frame = null)
        {
            let last = await this.ask("rcmail.env.last_frame_class");
            
            if (last === null || last === undefined || last === mel_metapage.Storage.unexist)
            {
                if (default_frame !== null)
                    last = default_frame;
                else
                    return;
            }

            return (await this.change_frame(last, true, wait));
        },

        get_current_title(current_task = null, _default = document.title){
            if (parent !== window) return parent.mel_metapage.Function.get_current_title(current_task, _default);

            if (current_task === null) current_task = (top ?? window).rcmail.env.current_task;

            if (current_task === 'chat' || current_task === 'discussion')
            {
                return 'Discussion';
            }
            else if (current_task === 'webconf')
            {
                return 'Visioconférence';
            }
            else {
                const frame = $(`iframe.${current_task}-frame`);
                if (frame.length > 0) return frame[0].contentDocument.title || _default;
                else if($(`.${current_task}-frame`).length > 0) return document.title;
                else return _default;
            }
        },

        /**
         * Execute un string depuis "TOP"
         * @param {string} exec String à éxécuter
         * @param {string} child Exécuter aussi dans les fenetres filles ?
         * @param  {JSON} args Autres arguments (eval etc....)
         */
        call(exec, child = false, args = {})
        {
            if (typeof exec !== "string")
            {
                const tmp_exec = JSON.stringify(exec);
                if (tmp_exec === undefined)
                {
                    if (typeof exec === "function")
                        exec = `(${exec.toString()})()`;
                    else
                        exec = exec.toString();
                }
                else
                    exec = tmp_exec;
            }

            let config = {
                exec:exec,
                child:child
            };
            
            if (args != null &amp;&amp; args !== undefined)
            {
                for (const key in args) {
                    if (Object.hasOwnProperty.call(args, key)) {
                        const element = args[key];
                        config[key] = element;
                    }
                }
            }

            if (window.workspaces !== undefined &amp;&amp; window.workspaces.sync !== undefined)
                workspaces.sync.PostToParent(config);    
            else {
                parent.postMessage(config);
            }     
            
            return this;
        },

        /**
         * Execute du script à un contexte au dessus.
         * @param {string} exec String à éxécuter
         * @param {boolean} child Exécuter aussi dans les fenetres filles ?
         * @param {JSON} args Autres arguments (eval etc....)
         */
        async callAsync(exec, child = false, args = {})
        {
            mel_metapage.Storage.set(mel_metapage.Storage.wait_call_loading, mel_metapage.Storage.wait_frame_waiting);
            this.call(exec, child, args);
            await wait(() => {
                return mel_metapage.Storage.get(mel_metapage.Storage.wait_call_loading) === mel_metapage.Storage.wait_frame_waiting;
            });

            return this;
        },

        /**
         * Modifie l'url du navigateur
         * @param {string} url URL à afficher 
         */
        title(url)
        {
            mel_metapage.Functions.call(`window.history.replaceState({}, document.title, '${url}')`);
            return this;
        },

        /**
         * Met (ou pas) la frame en cours et parente en loading.
         * @param {boolean} busy 
         */
        busy(busy = true)
        {
            const framed = window !== parent;
            mel_metapage.Storage.set("mel.busy", busy);
            if (busy)
            {
                this.call("rcmail.set_busy(true, 'loading')");
                if (framed)
                    rcmail.set_busy(true, 'loading')
            }
            else {
                this.call("rcmail.set_busy(false);rcmail.clear_messages();");
                if (framed)
                {
                    rcmail.set_busy(false);
                    rcmail.clear_messages();
                }
            }

            return this;

        },

        /**
         * Vérifie si l'application est occupée.
         * @returns {boolean}
         */
        is_busy()
        {
            const framed = window !== parent &amp;&amp; rcmail.busy != undefined;
            if (framed)
                return mel_metapage.Storage.get("mel.busy") === true || rcmail.busy;
            else
            {
                if (rcmail.busy === undefined)
                    return mel_metapage.Storage.get("mel.busy") === true;
                else
                    return rcmail.busy || mel_metapage.Storage.get("mel.busy") === true;
            }
        },

        /**
         * @async
         * Récupère une variable globale parente.
         * @param {string} props Variable à récupérer
         * @returns {Promise&lt;any>} Valeur de la variable
         */
        async ask(props)
        {
            this.call(`mel_metapage.Storage.set("mel.ask", ${props})`);
            await wait(() => mel_metapage.Storage.get("mel.ask") === null);
            props = mel_metapage.Storage.get("mel.ask");
            mel_metapage.Storage.remove("mel.ask");
            return props;
        },
        
        updateRichText (html) {
            return html.replace(/&lt;/g,'&amp;lt;');
        },

        remove_accents(string) {
            return string.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        },

        replace_dets(string = '', rep = '')
        {
            const dets = [
                " le ",
                " la ",
                " les ",
                " un ",
                " une ",
                " de ",
                " des ",
                " mon ",
                " ma ",
                " tes ",
                " ton ",
                " ta ",
                " son ",
                " sa ",
                " ses ",
                " notre ",
                " nos ",
                " vos ",
                " votre ",
                " leur ",
                " leurs ",
                " se ",
                " ce ",
                " cette ",
                " cet ",
                " ces ",
                " a ", 
                "l'"
            ];

            for (const iterator of dets) {
                string = string.replaceAll(iterator, rep);
            }

            while (string[0] === rep)
            {
                string = string.slice(1, string.length);
            }

            return string;
        },

        replace_special_char(string, rep = ''){
            const regexp = /[^a-zA-Z0-9_ -]/g;
            string = string.replace(regexp, rep);

            while (string[0] === rep)
            {
                string = string.slice(1, string.length);
            }

            return string;
        },

        /**
         * 
         * @param {string} url 
         * @returns 
         */
        webconf_url(url)
        {
            if (url[url.length - 1] === '&amp;') url = url.slice(0, url.length - 1);

            let val = url.toUpperCase();
            
            if (val.includes(rcmail.env["webconf.base_url"].toUpperCase())) {
              val = val.split("/");
              val = val[val.length - 1];
              val=  val.toUpperCase();
            }
            else if (val.includes('PUBLIC/WEBCONF')) val = val.split("_KEY=")[1].split("&amp;")[0]
            else {
                let link = WebconfLink.create({location:url, categories:[]});
                val = link.key;

                try {
                    if (val === ""){
                        link = WebconfLink.create({location:`#visio:${url}`, categories:[]});
                        val = link.key;
                    }
                } catch (error) {
                    val = null;
                }
            }

            
            return val || null;
        },

        _shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;
            // While there remain elements to shuffle...
            while (0 !== currentIndex) {
    
                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
    
                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            return array;
        },

        generateWebconfRoomName()
        {
            var charArray= ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            var digitArray= ["0","1","2","3","4","5","6","7","8","9"];
            var roomName = this._shuffle(digitArray).join("").substring(0,3) + this._shuffle(charArray).join("").substring(0,7);
            return this._shuffle(roomName.split("")).join("");
        },

        /**
         * Faire facilement une requête ajax
         * @param {string} url 
         * @param {JSON} datas 
         * @param {function} success 
         * @param {function} failed 
         * @param {string} type 
         * @returns {Promise&lt;any>} Appel ajax
         */
        ajax(url, datas = mel_metapage.Symbols.null, success = (datas) => {}, failed = (xhr, ajaxOptions, thrownError) => {console.error(xhr, ajaxOptions, thrownError)}, type = "POST")
        {
            let config = { // fonction permettant de faire de l'ajax
                type: type, // methode de transmission des données au fichier php
                url: url,//rcmail.env.ev_calendar_url+'&amp;start='+dateNow(new Date())+'&amp;end='+dateNow(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate()+1)), // url du fichier php
                success: success,
                error: failed
            };
            if (datas !== mel_metapage.Symbols.null)
                config["data"] = datas;

            return $.ajax(config);
        },

        /**
         * Execute un appel ajax get
         * @param {string} url 
         * @param {JSON} datas 
         * @param {function} success 
         * @param {function} failed
         * @returns {Promise&lt;any>}
         */
        get(url, datas = {}, success = (datas) => {}, failed = (xhr, ajaxOptions, thrownError) => {console.error(xhr, ajaxOptions, thrownError)})
        {
            for (const key in datas) {
                if (Object.hasOwnProperty.call(datas, key)) {
                    const element = datas[key];
                    url += `${(url.includes("?") ? "&amp;" : "?")}${key}=${encodeURIComponent(element)}`;
                }
            }
            return this.ajax(url, mel_metapage.Symbols.null, success, failed, "GET");
        },

        /**
         * Execute un appel ajax post
         * @param {string} url 
         * @param {Symbol|JSON} datas &lt;c>mel_metapage.Symbols.null&lt;/c> si aucune données.
         * @param {function} success 
         * @param {function} failed 
         */
        post(url, datas = mel_metapage.Symbols.null, success = (datas) => {}, failed = (xhr, ajaxOptions, thrownError) => {console.error(xhr, ajaxOptions, thrownError)})
        {
            return this.ajax(url, datas, success, failed);
        },

        /**
         * Contient différents fonctions pour mettre à jours certaines données.
         */
        update:{
            /**
             * Met à jours le calendrier.
             */
            calendar()
            {
                mel_metapage.Functions.call("rcmail.mel_metapage_fn.calendar_updated();");
                return this;
            }
        },

        /**
         * Vérifie si un handler existe sur un élément.
         * @param {DOMElement} element Element à tester.
         * @param {function} handler Fonction à vérifier
         * @param {string} type Type d'évènement
         * @returns {boolean}
         */
        handlerExist(element, handler, type = "click")
        {
            if (element.val !== undefined)
                element = element[0];
            return Enumerable.from(jQuery._data(element, 'events')[type]).where(x => x.handler + "" === handler + "").any();
        },

        /**
         * Fonctions lié au stockage nextcloud.
         */
        stockage:{
            /**
             * Ouvre la frame nextcloud et affiche un document en particulier (si il existe).
             * @param {JSON|Nextcloud_File} datas Données du document à afficher. 
             * {
                    file:nom du fichier,
                    folder:chemin du fichier
                }
             * @param {boolean} isfiledatas Si vrai, datas est un objet &lt;c>Nextcloud_File&lt;/c>
             * @param {function} thenFunc Action à faire une fois que l'on à changer de page.
             */
            go(datas, goFunc = null, thenFunc = null)
            {
                let init = 'new Nextcloud("rcmail.env.nextcloud_username")';
                let go = `.go(${JSON.stringify(datas)}, ${goFunc})`;
                let then = "";

                if (thenFunc !== null)
                {
                    then = `.then((a) => { (${thenFunc + ""})(a) })`;
                }

                return mel_metapage.Functions.call(init + go + then);
            },
            have_0_quota() {
                return rcmail.env.have_0_quota ?? false;
            },
            is_stockage_active() {
                const DEFAULT = false;
                return !!rcmail?.env?.why_is_not_active?.value ? rcmail.env.why_is_not_active.value === rcmail.env.why_is_not_active.consts.ST_ACTIVE : DEFAULT;
            },
            canDriveActions() {
                return !this.have_0_quota() &amp;&amp; this.is_stockage_active();
            }
        },

        /**
         * Recherche dans les mails
         * @param {string} itemToSearch Objet à chercher
         * @param {Array&lt;string>} fields Champs
         * @param {boolean} openFrame Ouvrir ou non la frame
         */
        async searchOnMail(itemToSearch, fields, openFrame = false)
        {
            if (parent === window)
            {
                if (openFrame)
                    await mel_metapage.Functions.change_frame("mail", true, true);

                 if ($("iframe.mail-frame").length > 0)
                    $("iframe.mail-frame")[0].contentWindow.postMessage({
                        exec:"search",
                        _integrated:true,
                        child:false,
                        args:[itemToSearch, fields]
                    });
                else
                    search_action(itemToSearch, fields);
            }
            else    
                mel_metapage.Functions.call(`mel_metapage.Functions.searchOnMail('${itemToSearch}', ${JSON.stringify(fields)}, ${openFrame})`);
            
            return this;
        },

        doActionFrame(frame, doAction, ...functionArgs)
        {
            //console.log("[doActionFrame]",frame, doAction, parent !== window);
            if (parent !== window)
            {
                mel_metapage.Functions.call("mel_metapage.doActionFrame", false, {
                    _integrated:true,
                    always:true,
                    args:[frame, doAction + "", ...functionArgs]
                });
            }
            else {

                if (typeof doAction === "string")
                {
                    doAction = new Function(`return (${doAction})(...arguments)`);
                }

                //Personne ouvert
                if ($(`.${frame}-frame`).length === 0)
                    doAction(0, ...functionArgs);
                else if ($(`iframe.${frame}-frame`).length > 0) //Frame ouverte
                    doAction(1, ...functionArgs);
                else //Page ouverte
                    doAction(2, ...functionArgs);

            }

            return this;
        },

        update_refresh_thing()
        {
            let current = (top ?? window).$(".refresh-current-thing");
            let action = window.webconf_helper.already() || (top ?? window).rcmail.env.current_frame_name === "webconf";

            if (action === true) current.addClass("disabled").attr("disabled", "disabled");
            else current.removeClass("disabled").removeAttr("disabled");

            return this;
        },

        isNavigator(symbol){
            switch (symbol) {
                case mel_metapage.Symbols.navigator.firefox:
                    return typeof InstallTrigger !== 'undefined';
            
                default:
                    throw 'Unknown navigator';
            }
        },

        /**
         * 
         * @param {string|JSON} _params - String sous forme '?dir=PATH&amp;fileid=ID' ou JSON sous forme {path:'', id:''}
         */
        async change_frame_nextcloud(_params = null)
        {
            const appfiles = '/apps/files/';
            const urlToAdd = _params.id === undefined &amp;&amp; _params.includes(appfiles) ? appfiles : "";
            let param = urlToAdd + (_params ?? "");
            let configArgs = null;

            //si _params n'est pas un string
            if (_params !== null)
            {
                if (_params.id !== undefined)
                    param = `${urlToAdd}?dir=${_params.path}&amp;fileid=${_params.id}`;

                configArgs = {
                    _params:urlencode(param)
                };
            }

            const url = `${rcmail.env.nextcloud_url}${param ?? ""}`;

            if (parent.$("iframe.stockage-frame").length > 0)
                parent.$("iframe.stockage-frame")[0].contentWindow.$("#mel_nextcloud_frame")[0].src = url;

            await this.change_frame("stockage", true, true, configArgs);

            parent.$("iframe.stockage-frame")[0].contentWindow.rcmail.env.nextcloud_gotourl = url;

            return this;
        },

        async comment_mail(uid, comment, folder = 'INBOX') {
            let data = uid;
            await this.post(
                mel_metapage.Functions.url('mel_metapage', 'comment_mail'), {
                    _uid:uid,
                    _comment:comment,
                    _folder:folder
                },
                (datas) => {
                    if (datas == 'false')
                    {
                        rcmail.display_message('Une erreur est survenue!', 'error');
                        data = false;
                    }
                    else data = datas;
                }
            );

            return data;
        },

        calculateObjectSizeInMo(obj) {
            const jsonString = JSON.stringify(obj);
            const blob = new Blob([jsonString]);
            const sizeInBytes = blob.size;
            const sizeInMb = sizeInBytes / (1024 * 1024);
            return sizeInMb;
        },

        colors:{
            kMel_Luminance(rgb) {
                    let R = rgb[0] / 255
                    let G = rgb[1] / 255
                    let B = rgb[2] / 255
                
                    if (R &lt;= 0.04045) { R = R /12.92 } else { R = ((R +0.055)/1.055) ** 2.4 }
                    if (G &lt;= 0.04045) { G = G /12.92 } else { G = ((G +0.055)/1.055) ** 2.4 }
                    if (B &lt;= 0.04045) { B = B /12.92 } else { B = ((B +0.055)/1.055) ** 2.4 }
                
                    const L = 0.2126 * R + 0.7152 * G + 0.0722 * B
                
                    return L
                },
                
                kMel_CompareLuminance(rgb1, rgb2) {
                    const l1 = this.kMel_Luminance(rgb1)
                    const l2 = this.kMel_Luminance(rgb2)
                
                    let ratio
                    if (l1 > l2) { ratio = (l1 + 0.05) / (l2 + 0.05) } else { ratio = (l2 + 0.05) / (l1 + 0.05) }
                
                    return ratio
                },
                
                kMel_LuminanceRatioAAA(rgb1, rgb2) {
                    const isAAA = this.kMel_CompareLuminance(rgb1, rgb2) > 4.5       
                    return isAAA
                },
                
                kMel_extractRGB (color) {
                    let regexp = /#[a-fA-F\d]{6}/g
                    let rgbArray = color.match(regexp)
                
                    if (rgbArray) {
                        rgbArray[0] = parseInt(color.slice(1,3), 16)
                        rgbArray[1] = parseInt(color.slice(3,5), 16)
                        rgbArray[2] = parseInt(color.slice(5,7), 16)

                        return rgbArray
                    }
                
                    regexp = /#[a-fA-F\d]{3}/g
                    rgbArray = color.match(regexp)
                
                    if (rgbArray) {
                        rgbArray[0] = parseInt(color.slice(1,2), 16)
                        rgbArray[1] = parseInt(color.slice(2,3), 16)
                        rgbArray[2] = parseInt(color.slice(3,4), 16)

                        return rgbArray
                    }
                
                    regexp = /\d+/g;
                    rgbArray = color.match(regexp);
                
                    if (rgbArray.length === 3 || rgbArray.length === 4) {
                        return rgbArray
                    }
                },
        }




    }
}; 

window.mel_metapage = mel_metapage;

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-BaseStorage.html">BaseStorage</a></li><li><a href="module-Color.html">Color</a></li><li><a href="module-Log.html">Log</a></li><li><a href="module-MEL_ELASTIC_UI.html">MEL_ELASTIC_UI</a></li><li><a href="module-MelLinq.html">MelLinq</a></li><li><a href="module-TchapManager.html">TchapManager</a></li></ul><h3>Namespaces</h3><ul><li><a href="MelMetapage.html">MelMetapage</a></li><li><a href="OCA.Bnum.html">Bnum</a></li><li><a href="OCA.Bnum.App.html">App</a></li><li><a href="Skins.html">Skins</a></li><li><a href="Tchap.html">Tchap</a></li><li><a href="Utilities.html">Utilities</a></li><li><a href="animation.html">animation</a></li><li><a href="aria.html">aria</a></li></ul><h3>Classes</h3><ul><li><a href="AMelScreenManager.html">AMelScreenManager</a></li><li><a href="Alarm.html">Alarm</a></li><li><a href="AlarmData.html">AlarmData</a></li><li><a href="AlarmPart.html">AlarmPart</a></li><li><a href="AudioVisualizer.html">AudioVisualizer</a></li><li><a href="BnumConnector.html">BnumConnector</a></li><li><a href="CalendarEvent.html">CalendarEvent</a></li><li><a href="CalendarLoader.html">CalendarLoader</a></li><li><a href="Calendar_Alarm.html">Calendar_Alarm</a></li><li><a href="CategoryData.html">CategoryData</a></li><li><a href="CategoryPart.html">CategoryPart</a></li><li><a href="ChatManager.html">ChatManager</a></li><li><a href="Connector.html">Connector</a></li><li><a href="EventField.html">EventField</a></li><li><a href="EventListenerDatas.html">EventListenerDatas</a></li><li><a href="EventManager.html">EventManager</a></li><li><a href="EventParts.html">EventParts</a></li><li><a href="EventView.html">EventView</a></li><li><a href="FreeBusyGuests.html">FreeBusyGuests</a></li><li><a href="GlobalModal.html">GlobalModal</a></li><li><a href="GlobalModalConfig.html">GlobalModalConfig</a></li><li><a href="GuestsPart_GuestsPart.html">GuestsPart</a></li><li><a href="IExt.html">IExt</a></li><li><a href="IntegratedVisio.html">IntegratedVisio</a></li><li><a href="InternalWebconfScreenManager.html">InternalWebconfScreenManager</a></li><li><a href="ListenerWebConfBar.html">ListenerWebConfBar</a></li><li><a href="MasterWebconfBar.html">MasterWebconfBar</a></li><li><a href="MasterWebconfBarItem.html">MasterWebconfBarItem</a></li><li><a href="MasterWebconfBarPopup.html">MasterWebconfBarPopup</a></li><li><a href="MelAudioManager.html">MelAudioManager</a></li><li><a href="MelAudioStruct.html">MelAudioStruct</a></li><li><a href="MelDataStore.html">MelDataStore</a></li><li><a href="MelIconPrevisualiser.html">MelIconPrevisualiser</a></li><li><a href="MelListingPrevisualiser.html">MelListingPrevisualiser</a></li><li><a href="MelNews.html">MelNews</a></li><li><a href="MelObject.html">MelObject</a></li><li><a href="MelPrevisualiser.html">MelPrevisualiser</a></li><li><a href="Mel_Promise.html">Mel_Promise</a></li><li><a href="MetapageModule.html">MetapageModule</a></li><li><a href="NewsPopup.html">NewsPopup</a></li><li><a href="Nextcloud_Document.html">Nextcloud_Document</a></li><li><a href="Nextcloud_Document_Config.html">Nextcloud_Document_Config</a></li><li><a href="Nextcloud_File.html">Nextcloud_File</a></li><li><a href="Nextcloud_Icon.html">Nextcloud_Icon</a></li><li><a href="Nextcloud_Response.html">Nextcloud_Response</a></li><li><a href="NotifierObject.html">NotifierObject</a></li><li><a href="OCA.Bnum.FileList.html">FileList</a></li><li><a href="ParapheurAction.html">ParapheurAction</a></li><li><a href="ParapheurMailAction.html">ParapheurMailAction</a></li><li><a href="RcmailDialog.html">RcmailDialog</a></li><li><a href="RcmailDialogButton.html">RcmailDialogButton</a></li><li><a href="RcmailDialogChoiceButton.html">RcmailDialogChoiceButton</a></li><li><a href="RightPannel.html">RightPannel</a></li><li><a href="SearchResult.html">SearchResult</a></li><li><a href="SearchResultCalendar.html">SearchResultCalendar</a></li><li><a href="Slot.html">Slot</a></li><li><a href="Slots.html">Slots</a></li><li><a href="SplittedDate.html">SplittedDate</a></li><li><a href="Sticker.html">Sticker</a></li><li><a href="TEActiveMouse.html">TEActiveMouse</a></li><li><a href="TEContainerActiveClassCtrl.html">TEContainerActiveClassCtrl</a></li><li><a href="TEErrorHandler.html">TEErrorHandler</a></li><li><a href="TEHashCtrl.html">TEHashCtrl</a></li><li><a href="TEHideIfNotActiveCtrl.html">TEHideIfNotActiveCtrl</a></li><li><a href="TEOverflowCtrl.html">TEOverflowCtrl</a></li><li><a href="TEOverflowScrollCtrl.html">TEOverflowScrollCtrl</a></li><li><a href="TEOverflowTransformCtrl.html">TEOverflowTransformCtrl</a></li><li><a href="Title.html">Title</a></li><li><a href="VisioManager.html">VisioManager</a></li><li><a href="VisualiserObject.html">VisualiserObject</a></li><li><a href="VisualiserObjectEx_VisualiserObjectEx.html">VisualiserObjectEx</a></li><li><a href="WarningPanel.html">WarningPanel</a></li><li><a href="Webconf.html">Webconf</a></li><li><a href="WebconfChat.html">WebconfChat</a></li><li><a href="WebconfPageCreator.html">WebconfPageCreator</a></li><li><a href="WebconfScreenManager.html">WebconfScreenManager</a></li><li><a href="WebconfWorkspaceManager.html">WebconfWorkspaceManager</a></li><li><a href="aria.Dialog.html">Dialog</a></li><li><a href="html_events.html">html_events</a></li><li><a href="html_li.html">html_li</a></li><li><a href="html_ul.html">html_ul</a></li><li><a href="mail_html_mail_html.html">mail_html</a></li><li><a href="mel_cancellable_html_timer.html">mel_cancellable_html_timer</a></li><li><a href="mel_filter.html">mel_filter</a></li><li><a href="mel_html.html">mel_html</a></li><li><a href="mel_html2.html">mel_html2</a></li><li><a href="mel_html_timer.html">mel_html_timer</a></li><li><a href="module-BaseStorage.BaseStorage.html">BaseStorage</a></li><li><a href="module-Color-Color.html">Color</a></li><li><a href="module-Color-ColorRGBA.html">ColorRGBA</a></li><li><a href="module-Log.BnumLog.html">BnumLog</a></li><li><a href="module-MEL_ELASTIC_UI.Mel_Elastic_Storage.html">Mel_Elastic_Storage</a></li><li><a href="module-MEL_ELASTIC_UI-Mel_CSS_Advanced_Rule.html">Mel_CSS_Advanced_Rule</a></li><li><a href="module-MEL_ELASTIC_UI-Mel_CSS_Array_Rule.html">Mel_CSS_Array_Rule</a></li><li><a href="module-MEL_ELASTIC_UI-Mel_CSS_Rule.html">Mel_CSS_Rule</a></li><li><a href="module-MEL_ELASTIC_UI-Mel_CSS_Style_Sheet.html">Mel_CSS_Style_Sheet</a></li><li><a href="module-MEL_ELASTIC_UI-Mel_Elastic.html">Mel_Elastic</a></li><li><a href="module-MelLinq-MelEnumerable.html">MelEnumerable</a></li><li><a href="module-MelLinq-MelKeyValuePair.html">MelKeyValuePair</a></li><li><a href="module-TchapManager-tchap_manager.html">tchap_manager</a></li><li><a href="rcube_splitter.html">rcube_splitter</a></li><li><a href="search.html">search</a></li><li><a href="searchBlock.html">searchBlock</a></li><li><a href="window.TEPauseCtrl.html">TEPauseCtrl</a></li></ul><h3>Events</h3><ul><li><a href="AlarmPart.html#event:onChange">onChange</a></li><li><a href="CategoryPart.html#event:onChange">onChange</a></li><li><a href="EventView.html#event:before_save">before_save</a></li><li><a href="EventView.html#event:on_dialog_before_close">on_dialog_before_close</a></li><li><a href="EventView.html#event:on_drop">on_drop</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Cette">Cette</a></li><li><a href="global.html#DAY_MS">DAY_MS</a></li><li><a href="global.html#DeleteLink">DeleteLink</a></li><li><a href="global.html#End">End</a></li><li><a href="global.html#Enum%25C3%25A9ration">Enumération</a></li><li><a href="global.html#GetLinkPopUp">GetLinkPopUp</a></li><li><a href="global.html#HOUR_MS">HOUR_MS</a></li><li><a href="global.html#Middle">Middle</a></li><li><a href="global.html#Mode">Mode</a></li><li><a href="global.html#Nextcloud">Nextcloud</a></li><li><a href="global.html#Nombres">Nombres</a></li><li><a href="global.html#PDFFindBar">PDFFindBar</a></li><li><a href="global.html#PDFFindController">PDFFindController</a></li><li><a href="global.html#Plugin">Plugin</a></li><li><a href="global.html#Portail">Portail</a></li><li><a href="global.html#RoundriveCreate">RoundriveCreate</a></li><li><a href="global.html#SELECTOR_CLASS_ROUND_CALENDAR">SELECTOR_CLASS_ROUND_CALENDAR</a></li><li><a href="global.html#Start">Start</a></li><li><a href="global.html#TEOnlyOnePlayingCtrl">TEOnlyOnePlayingCtrl</a></li><li><a href="global.html#TESessionCurrentSubtitle">TESessionCurrentSubtitle</a></li><li><a href="global.html#TESwipeCtrl">TESwipeCtrl</a></li><li><a href="global.html#TextLayerBuilder">TextLayerBuilder</a></li><li><a href="global.html#Tri">Tri</a></li><li><a href="global.html#URL">URL</a></li><li><a href="global.html#Update">Update</a></li><li><a href="global.html#ViewHistory">ViewHistory</a></li><li><a href="global.html#WSPReady">WSPReady</a></li><li><a href="global.html#_on_mention_update">_on_mention_update</a></li><li><a href="global.html#add_mobile_class">add_mobile_class</a></li><li><a href="global.html#api_notifications">api_notifications</a></li><li><a href="global.html#audio_alarms">audio_alarms</a></li><li><a href="global.html#audiourltotest">audiourltotest</a></li><li><a href="global.html#base_color">base_color</a></li><li><a href="global.html#base_text_color">base_text_color</a></li><li><a href="global.html#changeType">changeType</a></li><li><a href="global.html#checkAllIdentities">checkAllIdentities</a></li><li><a href="global.html#checkOneIdentity">checkOneIdentity</a></li><li><a href="global.html#check_workspace_integrity">check_workspace_integrity</a></li><li><a href="global.html#command_parapheur">command_parapheur</a></li><li><a href="global.html#componentToHex">componentToHex</a></li><li><a href="global.html#copy_signature">copy_signature</a></li><li><a href="global.html#createImage">createImage</a></li><li><a href="global.html#createLogo">createLogo</a></li><li><a href="global.html#createLogoType">createLogoType</a></li><li><a href="global.html#current_desktop_notification">current_desktop_notification</a></li><li><a href="global.html#date2ISO8601">date2ISO8601</a></li><li><a href="global.html#date2unixtime">date2unixtime</a></li><li><a href="global.html#datetimepickerFactory">datetimepickerFactory</a></li><li><a href="global.html#default_note_uid">default_note_uid</a></li><li><a href="global.html#delay">delay</a></li><li><a href="global.html#dialog">dialog</a></li><li><a href="global.html#dismiss_alarm">dismiss_alarm</a></li><li><a href="global.html#display_alarms">display_alarms</a></li><li><a href="global.html#dkSiRuleResizeMnu">dkSiRuleResizeMnu</a></li><li><a href="global.html#docReady">docReady</a></li><li><a href="global.html#download">download</a></li><li><a href="global.html#download_signature_outlook_htm">download_signature_outlook_htm</a></li><li><a href="global.html#download_signature_outlook_zip">download_signature_outlook_zip</a></li><li><a href="global.html#download_signature_thunderbird">download_signature_thunderbird</a></li><li><a href="global.html#enum_tooltip_mode">enum_tooltip_mode</a></li><li><a href="global.html#enum_tooltip_position">enum_tooltip_position</a></li><li><a href="global.html#ev_calendar_url">ev_calendar_url</a></li><li><a href="global.html#event_date_text">event_date_text</a></li><li><a href="global.html#fluxhtml">fluxhtml</a></li><li><a href="global.html#fluxrss">fluxrss</a></li><li><a href="global.html#folder_collapse">folder_collapse</a></li><li><a href="global.html#folder_collapse_unified">folder_collapse_unified</a></li><li><a href="global.html#folder_count">folder_count</a></li><li><a href="global.html#folder_count_unified">folder_count_unified</a></li><li><a href="global.html#folder_expand">folder_expand</a></li><li><a href="global.html#formatPhoneNumber">formatPhoneNumber</a></li><li><a href="global.html#format_datetime">format_datetime</a></li><li><a href="global.html#format_time">format_time</a></li><li><a href="global.html#fromunixtime">fromunixtime</a></li><li><a href="global.html#generate_canvas">generate_canvas</a></li><li><a href="global.html#getOutputScale">getOutputScale</a></li><li><a href="global.html#getPDFFileNameFromURL">getPDFFileNameFromURL</a></li><li><a href="global.html#getSignatureHTML">getSignatureHTML</a></li><li><a href="global.html#getTime">getTime</a></li><li><a href="global.html#get_organizer">get_organizer</a></li><li><a href="global.html#has_attendees">has_attendees</a></li><li><a href="global.html#has_permission">has_permission</a></li><li><a href="global.html#hide_header_row">hide_header_row</a></li><li><a href="global.html#init_recurrence_edit">init_recurrence_edit</a></li><li><a href="global.html#init_time_autocomplete">init_time_autocomplete</a></li><li><a href="global.html#isArrayLike">isArrayLike</a></li><li><a href="global.html#isAsync">isAsync</a></li><li><a href="global.html#isNullOrUndefined">isNullOrUndefined</a></li><li><a href="global.html#is_attendee">is_attendee</a></li><li><a href="global.html#is_internal_organizer">is_internal_organizer</a></li><li><a href="global.html#is_organizer">is_organizer</a></li><li><a href="global.html#libkolab_audittrail">libkolab_audittrail</a></li><li><a href="global.html#load_next_page">load_next_page</a></li><li><a href="global.html#loader">loader</a></li><li><a href="global.html#m_mp_Create">m_mp_Create</a></li><li><a href="global.html#m_mp_CreateDocumentIconContract">m_mp_CreateDocumentIconContract</a></li><li><a href="global.html#m_mp_CreateEvent">m_mp_CreateEvent</a></li><li><a href="global.html#m_mp_CreateEvent_inpage">m_mp_CreateEvent_inpage</a></li><li><a href="global.html#m_mp_CreateOrOpenFrame">m_mp_CreateOrOpenFrame</a></li><li><a href="global.html#m_mp_Help">m_mp_Help</a></li><li><a href="global.html#m_mp_InitializeDocument">m_mp_InitializeDocument</a></li><li><a href="global.html#m_mp_NotificationFilter">m_mp_NotificationFilter</a></li><li><a href="global.html#m_mp_NotificationGetDate">m_mp_NotificationGetDate</a></li><li><a href="global.html#m_mp_NotificationGetElement">m_mp_NotificationGetElement</a></li><li><a href="global.html#m_mp_NotificationProcess">m_mp_NotificationProcess</a></li><li><a href="global.html#m_mp_NotificationProcessAfterAction">m_mp_NotificationProcessAfterAction</a></li><li><a href="global.html#m_mp_NotificationRefresh">m_mp_NotificationRefresh</a></li><li><a href="global.html#m_mp_NotificationRun">m_mp_NotificationRun</a></li><li><a href="global.html#m_mp_NotificationSettings">m_mp_NotificationSettings</a></li><li><a href="global.html#m_mp_NotificationStartup">m_mp_NotificationStartup</a></li><li><a href="global.html#m_mp_NotificationsAction">m_mp_NotificationsAction</a></li><li><a href="global.html#m_mp_NotificationsAppendFilters">m_mp_NotificationsAppendFilters</a></li><li><a href="global.html#m_mp_NotificationsAppendToPanel">m_mp_NotificationsAppendToPanel</a></li><li><a href="global.html#m_mp_NotificationsClean">m_mp_NotificationsClean</a></li><li><a href="global.html#m_mp_NotificationsDelete">m_mp_NotificationsDelete</a></li><li><a href="global.html#m_mp_NotificationsGet">m_mp_NotificationsGet</a></li><li><a href="global.html#m_mp_NotificationsMerge">m_mp_NotificationsMerge</a></li><li><a href="global.html#m_mp_NotificationsRefreshUnread">m_mp_NotificationsRefreshUnread</a></li><li><a href="global.html#m_mp_NotificationsSet">m_mp_NotificationsSet</a></li><li><a href="global.html#m_mp_NotificationsShowUnread">m_mp_NotificationsShowUnread</a></li><li><a href="global.html#m_mp_NotificationsSort">m_mp_NotificationsSort</a></li><li><a href="global.html#m_mp_OpenTask">m_mp_OpenTask</a></li><li><a href="global.html#m_mp_RizomoRefreshNotifications">m_mp_RizomoRefreshNotifications</a></li><li><a href="global.html#m_mp_ShowDesktopNotification">m_mp_ShowDesktopNotification</a></li><li><a href="global.html#m_mp_ShowNotification">m_mp_ShowNotification</a></li><li><a href="global.html#m_mp_ToggleGroupOptionsUser">m_mp_ToggleGroupOptionsUser</a></li><li><a href="global.html#m_mp_UpdateCreateDoc">m_mp_UpdateCreateDoc</a></li><li><a href="global.html#m_mp_action_from_storage">m_mp_action_from_storage</a></li><li><a href="global.html#m_mp_anchor_ariane">m_mp_anchor_ariane</a></li><li><a href="global.html#m_mp_close_ariane">m_mp_close_ariane</a></li><li><a href="global.html#m_mp_full_screen_ariane">m_mp_full_screen_ariane</a></li><li><a href="global.html#m_mp_get_all_hashtag">m_mp_get_all_hashtag</a></li><li><a href="global.html#m_mp_help_video">m_mp_help_video</a></li><li><a href="global.html#m_mp_set_storage">m_mp_set_storage</a></li><li><a href="global.html#mel_metapage">mel_metapage</a></li><li><a href="global.html#mel_shortcuts_press">mel_shortcuts_press</a></li><li><a href="global.html#menuMgr">menuMgr</a></li><li><a href="global.html#menuScrollTiTask">menuScrollTiTask</a></li><li><a href="global.html#meteo">meteo</a></li><li><a href="global.html#mm_s_Action">mm_s_Action</a></li><li><a href="global.html#mm_s_AfficheResults">mm_s_AfficheResults</a></li><li><a href="global.html#mm_s_CreateOrUpdateFrame">mm_s_CreateOrUpdateFrame</a></li><li><a href="global.html#mm_s_OnClick">mm_s_OnClick</a></li><li><a href="global.html#mm_s_bodyClick">mm_s_bodyClick</a></li><li><a href="global.html#mm_s_extend">mm_s_extend</a></li><li><a href="global.html#modify_signature">modify_signature</a></li><li><a href="global.html#noContextMenuHandler">noContextMenuHandler</a></li><li><a href="global.html#onInputChange">onInputChange</a></li><li><a href="global.html#open_dialog">open_dialog</a></li><li><a href="global.html#parseISO8601">parseISO8601</a></li><li><a href="global.html#parse_datetime">parse_datetime</a></li><li><a href="global.html#plugin_text">plugin_text</a></li><li><a href="global.html#rcm_tb_label_insert">rcm_tb_label_insert</a></li><li><a href="global.html#rcm_tb_label_submenu">rcm_tb_label_submenu</a></li><li><a href="global.html#rcube_libcalendaring">rcube_libcalendaring</a></li><li><a href="global.html#rcube_mail_ui">rcube_mail_ui</a></li><li><a href="global.html#rcube_scroller">rcube_scroller</a></li><li><a href="global.html#rcube_tasklist">rcube_tasklist</a></li><li><a href="global.html#rcube_tasklist_ui">rcube_tasklist_ui</a></li><li><a href="global.html#rgbToHex">rgbToHex</a></li><li><a href="global.html#save_option">save_option</a></li><li><a href="global.html#saving_lock">saving_lock</a></li><li><a href="global.html#scImgMgr">scImgMgr</a></li><li><a href="global.html#scSiRuleEnsureVisible">scSiRuleEnsureVisible</a></li><li><a href="global.html#scrollIntoView">scrollIntoView</a></li><li><a href="global.html#send_francetransfert_message">send_francetransfert_message</a></li><li><a href="global.html#send_melanissimo_message">send_melanissimo_message</a></li><li><a href="global.html#send_with_francetransfert">send_with_francetransfert</a></li><li><a href="global.html#send_with_melanissimo">send_with_melanissimo</a></li><li><a href="global.html#serialize_recurrence">serialize_recurrence</a></li><li><a href="global.html#set_recurrence_edit">set_recurrence_edit</a></li><li><a href="global.html#set_title">set_title</a></li><li><a href="global.html#set_toolbar_item_valid">set_toolbar_item_valid</a></li><li><a href="global.html#settings_da_set_email_recup">settings_da_set_email_recup</a></li><li><a href="global.html#setup_calendar">setup_calendar</a></li><li><a href="global.html#show_header_row">show_header_row</a></li><li><a href="global.html#show_password_change">show_password_change</a></li><li><a href="global.html#show_rcube_manage_labels">show_rcube_manage_labels</a></li><li><a href="global.html#snooze_dropdown">snooze_dropdown</a></li><li><a href="global.html#startX">startX</a></li><li><a href="global.html#stockage">stockage</a></li><li><a href="global.html#tasklist_options_menu">tasklist_options_menu</a></li><li><a href="global.html#text2html">text2html</a></li><li><a href="global.html#text_color">text_color</a></li><li><a href="global.html#toHex">toHex</a></li><li><a href="global.html#treeMgr">treeMgr</a></li><li><a href="global.html#trigger">trigger</a></li><li><a href="global.html#unlock_saving">unlock_saving</a></li><li><a href="global.html#use_signature">use_signature</a></li><li><a href="global.html#validate_message">validate_message</a></li><li><a href="global.html#value">value</a></li><li><a href="global.html#visualValueCount">visualValueCount</a></li><li><a href="global.html#wait">wait</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Mar 11 2024 09:18:20 GMT+0100 (heure normale d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
